@page "/"
@rendermode InteractiveServer
@inherits BasePage<HomeViewModel>

<PageTitle>Startseite</PageTitle>

<main class="home">
    <RadzenRow>
    </RadzenRow>
    <RadzenRow>
        <RadzenColumn>
            <RadzenCard>
                <div class="card">
                    <RadzenText>Überstunden:</RadzenText>
                    <AsyncContent IsLoading="@ViewModel.LoadOvertime.Value" Error="@ViewModel.LoadOvertimeError.Value?.ToString()">
                        @ViewModel.Overtime.Value!.TotalMinutes
                    </AsyncContent>
                </div>
            </RadzenCard>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenCard>
                <RadzenText>Tage:</RadzenText>
            </RadzenCard>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenCard>
                <RadzenText>Tickets:</RadzenText>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow>
        <RadzenColumn Size="12">
            <RadzenPanel>
                <RadzenRow>
                    <RadzenColumn>
                        <YearPicker Year="@ViewModel.SelectedYear.Value" />
                    </RadzenColumn>
                    <RadzenColumn>
                        @* <RadzenDropDown>

                        </RadzenDropDown> *@
                    </RadzenColumn>
                </RadzenRow>
                <RadzenRow>
                    <RadzenColumn Size="12">
                        @RenderTable()
                    </RadzenColumn>
                </RadzenRow>
            </RadzenPanel>
        </RadzenColumn>
    </RadzenRow>
</main>

@code
{
    private RenderFragment RenderTable()
    {
        return
        @<div class="rz-data-grid rz-datatable rz-datatable-scrollable">
            <div class="rz-data-grid-data">
                <table class="rz-grid-table rz-grid-gridlines-both">
                    <thead>
                        <tr>
                            <th class="rz-frozen-cell rz-frozen-cell-left rz-text-align-center">
                                <div>
                                    <span class="rz-column-title">
                                        <span class="rz-column-title-content" />
                                    </span>
                                </div>
                            </th>
                            @for(int day = 1; day <= 31; day++)
                            {
                                <th>
                                    <div>
                                        <span class="rz-column-title">
                                            <span class="rz-column-title-content">
                                                @($"{day}".PadLeft(2, '0'))
                                            </span>
                                        </span>
                                    </div>
                                </th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @for (int month = 1; month <= 12; month++)
                        {
                            <tr class="rz-data-row">
                                <td class="rz-frozen-cell rz-frozen-cell-left">
                                    <span class="rz-cell-data">
                                        @ViewModel.MonthLabelShorts[month-1]
                                    </span>
                                </td>
                                @for (int day = 1; day <= 31; day++)
                                {
                                    <td>
                                        <span class="rz-cell-data">
                                            @RenderDay(month, day)
                                        </span>
                                    </td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    ;
    }

    private RenderFragment RenderDay(int month, int day)
    {
        return
        @<div>@ViewModel.GetDayLable(month, day)</div>;
    }
}
